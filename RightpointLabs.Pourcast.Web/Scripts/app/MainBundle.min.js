define("app/events",["jquery","toastr","signalr.hubs"],function(n,t){var i={};n.connection.eventsHub.client.dummyClientCallback=function(){};n.connection.hub.start({waitForPageLoad:!1});var u={on:function(t,r){n.connection.eventsHub.on(t,r);i[t]||(i[t]=[]);i[t].push(r)},off:function(t,r){n.connection.eventsHub.off(t,r);var u=i[t],f=u.indexOf(r);f>-1&&u.splice(f,1)},raise:function(n,t){i[n].forEach(function(n){n(t)})},send:function(t,i){n.connection.eventsHub.server[t].apply(n.connection.eventsHub.server,i)}},f=0,r=!1,e;n.connection.hub.stateChanged(function(i){var o=i.newState===n.connection.connectionState.connected,s=i.newState===n.connection.connectionState.disconnected;o?r&&(t.clear(e),t.success("Reconnected"),u.raise("Reconnected"),r=!1):s&&(r||(e=t.error("Disconnected","",{timeOut:0,extendedTimeOut:0}),f=0,r=!0))});n.connection.hub.disconnected(function(){setTimeout(function(){n.connection.hub.start()},Math.pow(2,f)*1e3);f++});u.on("Refresh",function(){window.location.reload()});return u});define("app/bindings",["ko","jquery","app/bubbles"],function(n,t,i){var r={};return r.init=function(){n.bindingHandlers.bubbles={init:function(n,r){i(t(n),r())},update:function(){}},function(){var t=function(t,i){return typeof t!="string"&&t.model?n.unwrap(t.model):i.$data},i=function(n,t){return typeof n!="string"&&n.resolver?n.resolver:u(t)},r=function(n){return typeof n!="string"&&n.key?n.key:n},u=function(n){var i,t,r;if(n.$data.resolver)return n.$data.resolver;for(i=0,t=null;!t;)r=n.$parents[i],r.resolver&&(t=r.resolver),i++;return t};n.bindingHandlers.oneComponent={init:function(){},update:function(u,f,e,o,s){var h=f(),v=r(h),y=i(h,s),c=t(h,s),p=y.resolve(v,c),l=p.reduce(function(n,t){var i=t.config;return n==null?i.isActive()?{name:t.name,config:i}:null:i.isActive()&&i.rank()>n.config.rank()?{name:t.name,config:i}:n},null),a;n.virtualElements.emptyNode(u);a=function(){return l?{name:l.name,params:c}:{name:"missing",params:c}};n.bindingHandlers.component.init(u,a,e,o,s)}};n.bindingHandlers.manyComponents={init:function(){},update:function(u,f,e,o,s){var h=f(),a=r(h),v=i(h,s),l=t(h,s),y=v.resolve(a,l),c;n.virtualElements.emptyNode(u);c=[];y.forEach(function(t){var u=t.config,i,r;u.isActive()&&(i=document.createElement("div"),c.push(i),r=function(){return{name:t.name,params:l}},n.bindingHandlers.component.init(i,r,e,o,s))});n.virtualElements.setDomNodeChildren(u,c)}};n.virtualElements.allowedBindings.oneComponent=!0;n.virtualElements.allowedBindings.manyComponents=!0}()},r});define("app/bubbles",["jquery"],function(){return function(n,t){var r,i;for(t=$.extend({minBubbleCount:5,maxBubbleCount:20,minBubbleSize:2,maxBubbleSize:8,minRiseTime:5,maxRiseTime:12,maxWaitTime:15},t||{}),r=t.minBubbleCount+Math.floor(Math.random()*(t.maxBubbleCount+1)),i=0;i<r;i++)n.append('<div class="bubble-container"><div class="bubble"><\/div><\/div>');n.find(".bubble-container").each(function(){var f=Math.floor(Math.random()*101),r=t.minBubbleSize+Math.floor(Math.random()*(t.maxBubbleSize-t.minBubbleSize+1)),n=Math.random()*(t.maxWaitTime+1),i=t.minRiseTime+Math.random()*(t.maxRiseTime-t.minRiseTime),u=$(this);u.css({left:f+"%","-webkit-animation-duration":i+"s","-moz-animation-duration":i+"s","-ms-animation-duration":i+"s","animation-duration":i+"s","-webkit-animation-delay":n+"s","-moz-animation-delay":n+"s","-ms-animation-delay":n+"s","animation-delay":n+"s"});u.children(".bubble").css({width:r+"px",height:r+"px"})})}});define("app/camera",["app/events","jquery"],function(n,t){function r(){var n=t.Deferred();return navigator.webkitGetUserMedia({video:!0},function(t){n.resolve(t)},function(){n.reject("Failed to initialize camera")}),n.promise()}function f(n){var i=document.createElement("video");return t(i).css({"z-index":-9999,opacity:0,position:"absolute",top:"-9999px",left:"-9999px"}),t("body").append(i),i.src=URL.createObjectURL(n),i.play(),i}function e(n,i,r,u){var f,e;return r||(r=100),u||(u=20),f=t.Deferred(),n.clientHeight>150?setTimeout(function(){f.resolve(i)},500):e=setInterval(function(){n.clientHeight>150?(console.log("Found with "+u+" left"),clearInterval(e),setTimeout(function(){f.resolve(i)},500)):(u--,u<=0&&(clearInterval(e),f.reject("failed to initialize camera")))},r),f.promise()}function o(n){var t=document.createElement("canvas"),i;return console.log("Taking shot..."),t.width=n.clientWidth,t.height=n.clientHeight,i=t.getContext("2d"),i.drawImage(n,0,0),t.toDataURL("image/png")}function u(n){if(i){i.push(n);return}i=[n];h().then(function(n){var u,f,r;for(u in i)f=i[u],r="/api/picture/Taken?tapId="+(f||""),console.log(r),t.post(r,{"":n})}).done(function(){i=null})}if(!(window.location.href.indexOf("camera=true")<0)){var s=window.location.protocol==="https:",h=(s?function(){return r().then(function(n){n.stop()}),function(){return r().then(function(n){var t=f(n);return e(t,{v:t,s:n},100,30)}).then(function(n){var i=n.v,r=n.s,u=o(i);return i.pause(),i.src=null,t(i).remove(),r.stop(),u})}}:function(){var n=r();return function(){return n.then(function(n){var t=f(n);return e(t,t,100,30)}).then(function(n){console.log(n);var i=o(n);return t(n).remove(),i})}})(),i=null;u(null);n.on("PourStarted",function(n){u(n.TapId)});n.on("PictureRequested",function(){u(null)})}});define("app/componentResolver",["ko"],function(n){function t(){this.components=n.observableArray([]);this.configs={}}n.components.register("missing",{require:"app/components/missing/viewModel"});var i=function(n,t){var i=this,r=n.name;return i.configs[r]||(i.configs[r]=new n.Config(t)),i.configs[r]};return t.prototype={register:function(t,i){var r=this;require(["app/components/"+t+"/config"],function(u){n.components.isRegistered(t)||n.components.register(t,{require:"app/components/"+t+"/viewModel"});r.components.push({key:i,name:t,Config:u})})},resolve:function(n,t){var r=this,u=r.components().filter(function(t){return t.key===n});return u.map(function(n){return{name:n.name,config:i.call(r,n,t)}})}},t});define("app/dataService",["jquery","app/model/tap","app/model/keg","app/model/beer","app/model/brewery","app/model/style","exports"],function(n,t,i,r,u,f,e){e.getTaps=function(){return n.get("/api/beerOnTap").then(function(n){var e=[];return n.forEach(function(n){var o,s,h,c,l;n.keg!=null&&(s=new u(n.brewery),h=new f(n.style),c=new r(n.beer,s,h),l=new i(n.keg,c));o=new t(n.tap,l);e.push(o)}),e})};e.getKegFromTapId=function(t){return n.get("/api/beerOnTap/"+t).then(function(n){var t,e,o,s;return n.keg!=null&&(t=new u(n.brewery),e=new f(n.style),o=new r(n.beer,t,e),s=new i(n.keg,o)),s})}});
//# sourceMappingURL=MainBundle.min.js.map
